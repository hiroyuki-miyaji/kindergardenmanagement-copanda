<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>連絡フォーム</title>

<!-- 共通CSS（メニュー・全体） -->
<link rel="stylesheet" href="./css/base.css">

<!-- ★ フォーム専用CSS（新規） -->
<link rel="stylesheet" href="./css/contact_form.css">

<!-- LIFF SDK -->
<script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>

<!-- 共通 API -->
<script src="./js/app.js"></script>

<!-- 当フォーム専用 -->
<script defer src="./js/contact_form.js"></script>
</head>

<body>
<div class="container">

  <header class="app-header">
    <div class="header-inner">
      <span class="app-title">幼稚園連絡システム copanda</span>
      <a href="index.html" class="home-link" aria-label="ホームへ戻る">🏠</a>
    </div>
  </header>

  <h2 id="title">連絡フォーム</h2>
  <div class="row">
    <h3><span id="viewContactType" class="view-text"></span></h3>
  </div>
  <!-- =========================
     ★ 表示モード（新設）
     ========================= -->
  <!-- ★ 共通ヘッダー情報（常に表示） -->
  <div id="commonInfoArea" class="form-section">
  
    <div class="row">
      <label>園児</label>
      <span id="viewKid" class="view-text"></span>
    </div>
  
    <div class="row">
      <label>日付</label>
      <span id="viewDate" class="view-text"></span>
    </div>
  
  </div>
  
  <!-- ★ 表示モード専用 -->
  <div id="viewDetailArea" class="form-section" style="display:none;">
  
    <div class="row">
      <label>連絡内容</label>
      <div id="viewDetail" class="view-detail"></div>
    </div>
  
    <div class="row btn-row">
      <button id="btnEdit" class="menu-btn" type="button">編集</button>
      <button id="btnBackView" class="menu-btn btn-back" type="button">戻る</button>
    </div>
  
  </div>


  <!-- ① 園児選択 -->
  <div id="editInfoArea" class="form-section">
    
    <div class="row">
      <label id="kidSelectLabel">園児</label>
      <div id="kidArea" class="kids-area"></div>
    </div>

    <!-- ② 日付選択（折り畳み） -->
    <div class="row hidden" id="calendarArea">
      <label>日程</label>

      <div id="childcareStatus" class="row hidden">
        <label>本日の預かり保育</label>
        <div id="childcareStatusText"></div>
      </div>

      <!-- 選択済み日付表示（トグル） -->
      <button type="button" id="selectedDateBox" class="date-box">
        日付を選択してください ▼
      </button>
  
      <!-- 折り畳みカレンダー -->
      <div id="calendarWrap" class="calendar-wrap">
        <div class="calendar-header">
          <button type="button" id="prevMonth" aria-label="前の月">‹</button>
          <span id="calendarTitle"></span>
          <button type="button" id="nextMonth" aria-label="次の月">›</button>
        </div>
        <div id="calendarGrid" class="calendar-grid"></div>
      </div>
    </div>
  </div>

  <!-- ③ フォーム本体 -->
  <div id="formBody" class="form-section" style="display:none;">

    <div class="row" id="row-baggage">
      <label>荷物持ち帰り</label>
      <label class="inline-label"><input type="radio" name="baggage" value="園受け取り">園受け取り</label>
      <label class="inline-label"><input type="radio" name="baggage" value="バス受け取り">バス受け取り</label>
      <label class="inline-label"><input type="radio" name="baggage" value="兄弟児に持たせる">兄弟児に持たせる</label>
      <label class="inline-label"><input type="radio" name="baggage" value="しない">しない</label>
    </div>
    <!-- ★ 預かり保育／長期預かり保育 -->
    <div class="row" id="row-care" style="display:none;">
    
      <!-- ===== 通常 預かり保育 ===== -->
      <div id="care-normal" style="display:none;">
        <label>預かり内容</label>
    
        <label class="inline-label">
          <input type="checkbox" id="normal_morning" value="朝預">
          朝預
        </label>
    
        <label class="inline-label">
          <input type="checkbox" id="normal_afternoon">
          午後
        </label>
    
        <!-- 午後チェック時に表示 -->
        <div id="normal_afternoon_options" class="sub-options" style="display:none;">
          <label class="inline-label">
            <input type="radio" name="normal_base" value="通常">
            通常
          </label>
          <label class="inline-label">
            <input type="radio" name="normal_base" value="課外後1">
            課外後1
          </label>
          <label class="inline-label">
            <input type="radio" name="normal_base" value="課外後2">
            課外後2
          </label>
        </div>
      </div>
    
      <!-- ===== 長期 預かり保育 ===== -->
      <div id="care-long" style="display:none;">
        <label>滞在時間</label>
      
        <!-- ラジオグループA -->
        <label class="inline-label">
          <input type="radio" name="long_base" value="ショート">
          ショート（14時まで）
        </label>
        <label class="inline-label">
          <input type="radio" name="long_base" value="ロング">
          ロング（17時まで）
        </label>
      
        <!-- 朝預（チェック） -->
        <div style="margin-top:6px;">
          <label class="inline-label">
            <input type="checkbox" id="long_morning" value="朝預">
            朝預
          </label>
        </div>
      
        <!-- 課外（ラジオグループB） -->
        <div style="margin-top:6px;">
          <label class="inline-label">
            <input type="radio" name="long_extra" value="課外後1">
            課外後1
          </label>
          <label class="inline-label">
            <input type="radio" name="long_extra" value="課外後2">
            課外後2
          </label>
        </div>
      </div>
  
    </div>

    <div class="row" id="row-send">
      <label>送り時間</label>
      <select id="send"></select>
    </div>

    <div class="row" id="row-pickup">
      <label>お迎え時間</label>
      <select id="pickup"></select>
    </div>

    <div class="row" id="row-reason">
      <label>理由</label>
      <div id="reasonArea"></div>
    </div>
    
    <!-- ★ アレルギー -->
    <div class="row" id="row-allergy">
      <label>アレルギー</label>
    
      <label class="inline-label">
        <input type="radio" name="allergy_flag" value="あり">
        あり
      </label>
      <label class="inline-label">
        <input type="radio" name="allergy_flag" value="なし" checked>
        なし
      </label>
    
      <!-- 有の場合のみ表示 -->
      <div id="allergy_options" style="display:none; margin-top:6px;">
        <label class="inline-label">
          <input type="checkbox" name="allergy_item" value="小麦"> 小麦
        </label>
        <label class="inline-label">
          <input type="checkbox" name="allergy_item" value="ナッツ"> ナッツ
        </label>
        <label class="inline-label">
          <input type="checkbox" name="allergy_item" value="卵"> 卵
        </label>
        <label class="inline-label">
          <input type="checkbox" name="allergy_item" value="乳"> 乳
        </label>
        <label class="inline-label">
          <input type="checkbox" name="allergy_item" value="甲殻類"> 甲殻類
        </label>
        <label class="inline-label">
          <input type="checkbox" name="allergy_item" value="日光"> 日光
        </label>
      </div>
    </div>
    
    <div class="row" id="row-memo">
      <label>備考</label>
      <textarea id="memo" maxlength="100" placeholder="備考（100文字以内）"></textarea>
    </div>

    <div class="row" id="row-lunch">
      <label>給食</label>
      <label class="inline-label"><input type="radio" name="lunch" value="必要">必要</label>
      <label class="inline-label"><input type="radio" name="lunch" value="不要">不要</label>
    </div>

    <div class="row" id="row-bus">
      <label>キャンセルバス</label>
      <label class="inline-label"><input id="bus_morning" type="checkbox" value="朝バス">朝バス</label>
      <label class="inline-label"><input id="bus_evening" type="checkbox" value="帰りバス">帰りバス</label>
    </div>

    <div class="row" id="row-guardian">
      <label>来園する保護者</label>
      <label class="inline-label"><input type="radio" name="guardian" value="母親">母親</label>
      <label class="inline-label"><input type="radio" name="guardian" value="父親">父親</label>
      <label class="inline-label"><input type="radio" name="guardian" value="その他">その他</label>
      <input id="guardianOther" type="text" placeholder="その他の場合入力">
    </div>
    <!-- ★ キャンセル操作エリア（編集モード用） -->
    <div class="row" id="cancelArea" style="display:none;">
    
      <!-- キャンセル期限切れメッセージ -->
      <p id="cancelLimitNotice" class="notice-text" style="display:none;">
        ※ キャンセル期限を過ぎています（当日 9:10 まで）
      </p>
    
      <!-- キャンセルボタン -->
      <button id="btnDelete" class="menu-btn btn-cancel" type="button" style="display:none;">
        連絡をキャンセル
      </button>    
    </div>
    
    <div class="row btn-row">
      <button id="btnBack" class="menu-btn btn-back" type="button">
        戻る
      </button>
      <button id="btnSubmit" class="menu-btn" type="button" >
        送信
      </button>
    </div>

  </div>
</div>
</body>
</html>
